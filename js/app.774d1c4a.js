(function(t){function e(e){for(var i,r,o=e[0],c=e[1],l=e[2],u=0,d=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&d.push(a[r][0]),a[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);h&&h(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,o=1;o<s.length;o++){var c=s[o];0!==a[c]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var i={},a={app:0},n=[];function r(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=i,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(s,i,function(e){return t[e]}.bind(null,i));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var h=c;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"0947":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABC9JREFUeF7tWn+IFVUUPmdmQRYiaMOIIAIRJCKIQIIgYiMId0Xe3nt33sqGIJFJEoQhigSFIYWkoohiiRT5Y525974XRCBCBBFIEEFUBJEEEkggkggu8maOXJi33IbUufPeLD7uzJ8z3znnO98557777gyC5xd6nj80AjQd4LkCzQh43gDNItiMQDMCnivQjIBrAyil3gKAw0T0hhDiE1f7YeOllE8FQXAgy7J/AWCXEOKSSwynDojjeCIMw6v9AIi4hzH2nkvAYWK73e7TaZqeA4Anc79HOefbXGIMJIAJRER7hRDvugQdBjaO42fGxsYWiGiN5a9eAUwgpZSp+PuFJD7knO8eRmJlfCilniWic4i42sL/EoZhu9Vq/VbGx1IXu4D7WKWUqfgHBdt9nPOdVfy52Cil1gLAAgCssux+JqK2EOJ3F18G6zQCtnOllKn4XvseEX0shNjhSqIsvtvtPpfP/BOWzU958n+U9WPjKgtgnGitdxLRRwURDgohtlchczebJEmeD4LAVP7xPo6Ifuz1eu25ubk/q8YbSAATVEq5AxH3/UdVxEOMsberkiraJUnyQp78Y0uzi/gDIrZnZmb+GiTOwALknbCdiPYXiBzhnJs9w0CX1vpFIjKVf9RydDEMw6jVal0eyPkga0AxsFLKVPxg4b7zz5Jtr7V+iYjOAsAj1v3v0zRtR1H096DJG/uhdECfSH+XWCB2nHO+1ZWslPJlRDSVf9ia+e/Gx8ej6enpK67+7oQfqgD5OGwjoiOFNeFTxtiWsqSllK8EQXCWiB6yZv5bAGgzxv4p66cMbugC5CJsJaJjNgEiOimEeO1epDqdzro0TRcQ8UEL+w0iRoyxpW34vfyUfV6LACa4lHILIh4vEPmMc775TuSSJFlvKg8AD1iYC4uLi+35+flrZZNywdUmgCGhlDIVP1Eg9AXnfNP/LKIb8h3euPXsvJn5qamp6y5JuWBrFSAfh82m/QukTnPOX7UWzxkAMJVfYeG+zlf7Gy4JuWJrFyAXYRMRfV4gt8A53yil5PlqP9Z/TkRfZVkWRVF00zUhV/yyCJCLME9Ep2yCiBgTkQCAoH8fEb/s9Xom+VuuyVTBL5sA+cK4ERHP3IVoZ2JiIpqcnOxVSaaKzbIKYAh2Op0oyzJzilO8JGMsQkSqkkhVm0aAqspVsZNS+jsCWmt/F0Gttb8/g1prfzdCXm+Fvf4zpLX29++w1trfAxGvj8S8PhTVWvt7LO71ixGvX415/XLU69fjXn8gUfxGyJwJePWJTBzHK8Mw/BUAVprk78OPpE5wzl93OaxxPhJTSr2DiOvNCw/G2GmXYHVgzWdyiPgmIl5O0/Ti7OyseYdY+nIWoLTnEQE2AoxIoWqj2XRAbdKOiOOmA0akULXRbDqgNmlHxHHTASNSqNpoet8BtwFqXGFf4fPk3AAAAABJRU5ErkJggg=="},"0c55":function(t,e){t.exports="data:image/png;base64,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"},4154:function(t,e,s){},"52f1":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABARJREFUeF7tmk2IHEUUgN+buioeI548BK8BQTwJ2WMOwlKveqIghmgSRY2IEIwmaDTGYIgu0SUhicaQoITqrt7ti1fFkxcvQgRPXvTkRbzudj3p0LMsw0xXdXdND7jV13r1fr55P13Vg7DHH9zj8UMEsMwMKIpi39bW1j6l1K/L8mNpGZDnecLMugqcmVOl1HgZEJYCIM/zJ5j5990BLwvC4AC01kIIsT3r114GhEEBaK0fEUL840j1G0T0ylDlMBiAoige297e/ssnMET8SEr5gY9sX5lBAMyqeZfjzHxBKXXWJdd3feEAjDFPAsAvHR29SETvddzrtW2hADY3N58py/InL0/mC10iond66pi7fWEANjY2Dllrvw/hOCJellKeCqFrWsdCAOx+yQnlNDOvKaXeDqVvoic4gDRNj45Go1uhHa30IeIVKeVbIXUHBZBl2RuI+GVIB2foWieik6FsBAOQZdlpRLzY1zFE1MzsOhdcJaLX+9p6kFUhlGRZ9jEinnHpQsR7zPxck5y19kMhRHVWeN6h7zoRveqy6VrvDcAYswYAPnV5x1r7zWg0+sEFIEmSc3me32XmF5pkEfGmlPKEK8hGHX02G2NuAsAxDx1fEdHxNE0P+gKodOZ5fpuZjzTpZ+ZbSqmXPXyYKdI1A9AY8x0ANKZzbXGnXtsCqCF8zcwvOQK8TURHu0BoDUBr/ZAQogr+WZdBRFyTUu7M7i4Aagg3mPm4w95dInrR5dP0eisAWutH6+BXXIaY+VOl1Ondcl0B1BCuMbOr6X1LRI19ozMArfX+OvinXMEDwHkien9arg+ASleWZeuI6Bp/94jINUF2XPPOAGPMzwDwtCt4Zj6rlLowS64vgBrCFUR80zEdtJTysMvXar0NgD8A4PEmpdbaU0mSXJ4nEwJAXQ6fMXPjuaB6n6jGqQuCNwDXAYeZTyql1psMhgJQQ7jEzPNOiPfLslwZj8d/BwNQG925yt6tmJlPKKWqd4LGJySAypAx5hMAeHfK6H0hxHh1dfU3lz+tSmCibDoTrLVHkiS542MsNIAawnkAmFydtQq+E4BJJgDAa9baa0qpBx83fJ5FAKjspml6bjQaHRBCnPH95Sf+evcAnwBdMosC4LLbtB4B9KHXdm/MgJanwbaAu8jHEuhCreueWAKxBNrdCHXNtDb7Yg9oQ6uvbOwBsQfEHtDqWrxvyfnsj03Qh1IomdgEYxOMTTA2wTYfR0P1nngj1EAgjsEh0mxiI47BOAbjGIxjMI5Bz3+JDdWc4xgcivTEjjHmXwB4eJ5da+1KkiQ/DuXXoBlQBVUUxf6yLL9g5kNTQf6JiJ9LKas/Xg72DA5gsMg8DUUAnqD+t2J7PgP+Ayd8i1+O0opNAAAAAElFTkSuQmCC"},5622:function(t,e){t.exports="data:image/png;base64,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"},"56d7":function(t,e,s){"use strict";s.r(e);s("25ba"),s("5f1c"),s("6ba0"),s("b47f");var i=s("f022"),a=s.n(i),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app"},[s("Palette"),t._v(" "),s("Brush"),t._v(" "),s("Draw"),t._v(" "),s("Layer")],1)},r=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"brush"},[s("h4",{staticClass:"brush-title"},[t._v("刷")]),t._v(" "),s("div",{staticClass:"brush-content"},t._l(t.list,(function(e,i){return s("div",{key:i,staticClass:"brush-item",class:{active:t.brushIndex===e.value},style:"margin-top:"+e.top+"px",on:{click:function(s){return t.selectItem(e.value)}}},[t._v("\n      "+t._s(e.name)+"\n    ")])})),0),t._v(" "),s("div",{staticClass:"brush-content-select"},[s("div",{staticClass:"brush-select"},[s("div",{staticClass:"brush-select-item",on:{click:function(e){return t.selectAction(1,0)}}},[t._v("+x")]),t._v(" "),s("div",{staticClass:"brush-select-item",on:{click:function(e){return t.selectAction(0,-1)}}},[t._v("+y")])]),t._v(" "),s("div",{staticClass:"brush-select"},[s("div",{staticClass:"brush-select-item",on:{click:function(e){return t.selectAction(-1,0)}}},[t._v("-x")]),t._v(" "),s("div",{staticClass:"brush-select-item",on:{click:function(e){return t.selectAction(0,1)}}},[t._v("-y")])])]),t._v(" "),s("div",{staticClass:"brush-footer"},[s("div",{staticClass:"brush-footer-item",class:{active:t.showGrid},on:{click:function(e){return t.setValue("showGrid")}}},[t._v("\n      Grid\n    ")]),t._v(" "),s("div",{staticClass:"brush-footer-item",class:{active:t.showLayer},on:{click:function(e){return t.setValue("showLayer")}}},[t._v("\n      Layer\n    ")])])])},c=[],l=(s("1bc7"),s("e5b4"),{data:function(){return{list:[{name:"画笔(单)",value:"brush"},{name:"画笔(块)",value:"brushs"},{name:"橡皮擦(单)",value:"detele",top:10},{name:"橡皮擦(块)",value:"deteles"},{name:"拖拽移动",value:"move",top:10},{name:"选择像素",value:"select"},{name:"颜色替换",value:"repalce"}]}},computed:{brushIndex:function(){return this.$state.brushIndex},showGrid:function(){return this.$state.showGrid},showLayer:function(){return this.$state.showLayer}},methods:{selectItem:function(t){if(this.$state.brushIndex===t)return!1;this.$state.selects=[],this.$state.brushIndex=t,this.$state.drawIndex+=1},setValue:function(t){this.$state[t]=!this.$state[t],this.$state.drawIndex+=1},selectAction:function(t,e){var s=this,i=this.$state.layer.find((function(t){return s.$state.layerIndex===t.uid})),a=this.$state.selects,n=[];if(i&&i.show){var r=t,o=this.$state.size*e;a.forEach((function(t,e){var a=e%s.$state.size,c=Math.floor(e/s.$state.size),l=e+r+o;a>0&&a%s.$state.size===0&&c!==s.$state.gridSize||(n[l]=t),delete i.data[e]})),n.forEach((function(t,e){var a=e%s.$state.size,n=Math.floor(e/s.$state.size);i.data[a+n*s.$state.size]=t})),this.$state.selects=[].concat(n),this.$save()}}}}),h=l,u=(s("d8be"),s("5d22")),d=Object(u["a"])(h,o,c,!1,null,"d7095830",null),f=d.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"palette"},[s("h4",{staticClass:"palette-title"},[t._v("颜色板")]),t._v(" "),s("div",{staticClass:"palette-content"},t._l(t.paletteList,(function(e,i){return s("div",{key:i,staticClass:"palette-content-item",class:{active:t.index===i},on:{click:function(e){return t.selectItem(i)}}},[s("div",{staticClass:"palette-content-block",style:"background-color: #"+e+";"})])})),0),t._v(" "),s("div",{staticClass:"palette-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.color,expression:"color"}],staticClass:"palette-input-block",attrs:{type:"color"},domProps:{value:t.color},on:{input:function(e){e.target.composing||(t.color=e.target.value)}}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.color,expression:"color"}],staticClass:"palette-input-prix",attrs:{type:"text"},domProps:{value:t.color},on:{input:function(e){e.target.composing||(t.color=e.target.value)}}})])])},g=[],v={computed:{index:function(){return this.$state.colorIndex},paletteList:function(){return this.$state.paletteList},color:{get:function(){return"#"+this.paletteList[this.index]},set:function(t){this.paletteList[this.index]=t.substr(1),this.$save()}}},methods:{selectItem:function(t){this.$state.colorIndex=t}}},p=v,x=(s("b593"),Object(u["a"])(p,A,g,!1,null,"eac55904",null)),I=x.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"draw"},[s("div",{staticClass:"draw-header"},[s("span",{staticClass:"draw-header-item",on:{click:t.importProject}},[t._v("导入工程")]),t._v(" "),s("span",{staticClass:"draw-header-item",on:{click:t.exportProject}},[t._v("导出工程")]),t._v(" "),s("span",{staticClass:"draw-header-item",on:{click:t.exportImage}},[t._v("导出图片")]),t._v(" "),s("span",{staticClass:"draw-header-item",staticStyle:{"margin-left":"40px"},on:{click:t.back}},[t._v("撤回")]),t._v(" "),s("span",{staticClass:"draw-header-item",on:{click:t.forward}},[t._v("前进")])]),t._v(" "),s("div",{staticClass:"draw-content",on:{mousedown:t.touchstart}},[s("canvas",{ref:"canvas",staticClass:"draw-canvas",style:t.canvasStyle})])])},m=[],w=(s("b76b"),s("fc02"),s("a450"),function(t){return void 0===t||null===t}),b={mounted:function(){var t=this;this.$nextTick((function(){var e=t.$refs.canvas.parentNode;t.moveMaxX=t.width-e.clientWidth,t.moveMaxY=t.height-e.clientHeight,document.addEventListener("mousemove",t.touchmove),document.addEventListener("mouseup",t.touchend),t.draw()}))},computed:{canvasStyle:function(){return"transform: translate(".concat(this.$state.x,"px, ").concat(this.$state.y,"px)")},drawIndex:function(){return this.$state.drawIndex},width:function(){return this.$state.width},height:function(){return this.$state.height},gridSize:function(){return this.$state.gridSize},size:function(){return this.$state.size}},methods:{getGridPs:function(t){var e=t.pageX,s=t.pageY,i=this.$refs.canvas,a=i.parentNode.getBoundingClientRect(),n=e-a.left-this.$state.x,r=s-a.top-this.$state.y;return{x:n,y:r}},touchstart:function(t){if(2===t.button)return!1;if(this.isTouch=!0,this.pageX=t.pageX,this.pageY=t.pageY,this._x=this.$state.x,this._y=this.$state.y,this._selects=JSON.parse(JSON.stringify(this.$state.selects)),this.mouse=t.button,0===t.button){var e=this.getGridPs(t);this.indexX=Math.floor(e.x/this.gridSize),this.indexY=Math.floor(e.y/this.gridSize),this.action()}},touchmove:function(t){if(this.isTouch)if(this.offsetX=t.pageX-this.pageX,this.offsetY=t.pageY-this.pageY,0===this.mouse){var e=this.getGridPs(t);this.targetX=Math.floor(e.x/this.gridSize),this.targetY=Math.floor(e.y/this.gridSize),this.action()}else 1===this.mouse&&this.move()},touchend:function(t){this.isTouch=!1,this.indexX=null,this.indexY=null,this.targetX=null,this.targetY=null,this.offsetX=null,this.offsetY=null,this.$state.cacelayer=JSON.parse(JSON.stringify(this.$state.layer))},draw:function(){var t=this,e=this.$refs.canvas,s=e.getContext("2d");if(e.width=this.width,e.height=this.height,s.clearRect(0,0,1e4,1e4),this.$state.showLayer&&this.$state.layer.forEach((function(e){e.show&&e.data.forEach((function(e,i){if(!w(e)){var a=i%t.size,n=Math.floor(i/t.size);s.fillStyle="#".concat(t.$state.paletteList[e]),s.fillRect(a*t.gridSize,n*t.gridSize,t.gridSize,t.gridSize)}}))})),this.$state.showGrid){var i=this.getGrid();s.drawImage(i,0,0,this.width,this.height)}this.$state.selects.length&&this.$state.selects.forEach((function(e,i){if(!w(e)){var a=i%t.size,n=Math.floor(i/t.size);s.strokeStyle="#ffffff",s.strokeRect(a*t.gridSize,n*t.gridSize,t.gridSize,t.gridSize)}}))},getGrid:function(){if(!this.canvas){this.canvas=document.createElement("canvas");var t=this.canvas.getContext("2d");this.canvas.width=this.width,this.canvas.height=this.height;var e=this.gridSize,s=this.gridSize;t.strokeStyle="#333",t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.lineTo(0,0);for(var i=e+.5;i<this.width;i+=e)t.moveTo(i,0),t.lineTo(i,this.height),t.stroke();for(var a=s+.5;a<this.height;a+=s)t.moveTo(0,a),t.lineTo(this.width,a),t.stroke()}return this.canvas},action:function(){switch(this.$state.brushIndex){case"brush":this.brush();break;case"brushs":this.brushs();break;case"move":this.move();break;case"detele":this.detele();break;case"deteles":this.deteles();break;case"select":this.selectGrid();break}},brush:function(){var t=this,e=this.$state.layer.find((function(e){return t.$state.layerIndex===e.uid}));e&&e.show&&(e.data[this.indexX+this.indexY*this.size]=this.$state.colorIndex,this.targetX&&this.targetY&&(e.data[this.targetX+this.targetY*this.size]=this.$state.colorIndex)),this.draw()},brushs:function(){var t=this,e=this.$state.layer.find((function(e){return t.$state.layerIndex===e.uid}));if(e&&e.show&&(e.data[this.indexX+this.indexY*this.size]=this.$state.colorIndex,this.targetX&&this.targetY)){var s=this.getBlockBoxIndex(this.indexX,this.indexY,this.targetX,this.targetY);s.forEach((function(s){e.data[s]=t.$state.colorIndex}))}this.draw()},move:function(){this.offsetX&&this.offsetY&&(this.$state.x=this._x+this.offsetX,this.$state.y=this._y+this.offsetY,this.$state.x>0&&(this.$state.x=0),this.$state.x<-this.moveMaxX&&(this.$state.x=-this.moveMaxX),this.$state.y>0&&(this.$state.y=0),this.$state.y<-this.moveMaxY&&(this.$state.y=-this.moveMaxY))},detele:function(){var t=this,e=this.$state.layer.find((function(e){return t.$state.layerIndex===e.uid}));e&&e.show&&(delete e.data[this.indexX+this.indexY*this.size],this.targetX&&this.targetY&&delete e.data[this.targetX+this.targetY*this.size]),this.draw()},deteles:function(){var t=this,e=this.$state.layer.find((function(e){return t.$state.layerIndex===e.uid}));if(e&&e.show&&(e.data[this.indexX+this.indexY*this.size]=this.$state.colorIndex,this.targetX&&this.targetY)){var s=this.getBlockBoxIndex(this.indexX,this.indexY,this.targetX,this.targetY);s.forEach((function(t){delete e.data[t]}))}this.draw()},selectGrid:function(){var t=this,e=this.$state.layer.find((function(e){return t.$state.layerIndex===e.uid})),s=this.$state.selects,i=this._selects;if(e&&e.show){var a=this.indexX+this.indexY*this.size;if(w(i[a])?s[a]=e.data[a]:delete s[a],this.targetX&&this.targetY){var n=this.getBlockBoxIndex(this.indexX,this.indexY,this.targetX,this.targetY);n.forEach((function(t){w(i[t])?s[t]=e.data[t]:delete s[t]}))}}this.draw()},getBlockBoxIndex:function(t,e,s,i){for(var a=Math.abs(t-s)+1,n=Math.abs(e-i)+1,r=[],o=Math.min(t,s),c=Math.min(e,i),l=0;l<a;l++)for(var h=0;h<n;h++)r.push(l+o+(h+c)*this.size);return r},back:function(){this.$back()},forward:function(){this.$forward()},importProject:function(){var t=this,e=document.createElement("input");e.type="file",e.onchange=function(e){var s=e.target.files[0],i=new FileReader;i.onload=function(){var e=decodeURIComponent(i.result),a=JSON.parse(e);t.projectName=s.name,t.$state.layer=a.layer,t.$state.paletteList=a.paletteList,t.$state.layerIndex=a.layer[0].uid,t.$state.drawIndex+=1},i.readAsText(s,"UTF-8")},e.click()},exportProject:function(){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify({paletteList:this.$state.paletteList,layer:this.$state.layer}))),t.setAttribute("download",this.projectName||"项目工程.jc"),t.click()},exportImage:function(){var t=this.$state.showGrid;this.$state.showGrid=!1,this.draw(),this.$state.showGrid=t;var e=this.$refs.canvas.toDataURL("image/png",1),s=document.createElement("a");s.setAttribute("href",URL.createObjectURL(this.base64ToBlob(e))),s.setAttribute("download","图片.png"),s.click(),this.draw()},base64ToBlob:function(t){for(var e=t.split(";base64,"),s=e[0].split(":")[1],i=window.atob(e[1]),a=i.length,n=new Uint8Array(a),r=0;r<a;++r)n[r]=i.charCodeAt(r);return new Blob([n],{type:s})}},watch:{drawIndex:function(){this.draw()}}},C=b,E=(s("8cc7"),Object(u["a"])(C,y,m,!1,null,"4715eb3c",null)),O=E.exports,B=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layer"},[i("h4",{staticClass:"layer-title"},[t._v("图层")]),t._v(" "),i("div",{ref:"view",staticClass:"layer-view"},[i("transition-group",{attrs:{name:"list",tag:"p"}},t._l(t.layer,(function(e,a){return i("div",{key:e.uid,staticClass:"layer-item",class:{active:t.layerIndex===e.uid},on:{click:function(s){return t.selectItem(e.uid,s)}}},[e.show?i("img",{staticClass:"layer-icon",attrs:{src:s("0c55")},on:{click:function(s){return t.showLayer(e,s)}}}):i("img",{staticClass:"layer-icon",attrs:{src:s("5622")},on:{click:function(s){return t.showLayer(e,s)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"item.name"}],staticClass:"layer-text",attrs:{type:"text"},domProps:{value:e.name},on:{input:function(s){s.target.composing||t.$set(e,"name",s.target.value)}}}),t._v(" "),i("img",{staticClass:"layer-icon",class:{disabled:0===a},attrs:{src:s("52f1")},on:{click:function(e){return t.upLayer(a,e)}}}),t._v(" "),i("img",{staticClass:"layer-icon",class:{disabled:a===t.layer.length-1},staticStyle:{transform:"rotate(180deg)"},attrs:{src:s("52f1")},on:{click:function(e){return t.downLayer(a,e)}}}),t._v(" "),i("img",{staticClass:"layer-icon",attrs:{src:s("0947")},on:{click:function(e){return t.removeLayer(a,e)}}})])})),0)],1),t._v(" "),i("div",{staticClass:"layer-add-item",on:{click:t.addLayer}},[t._v("新建图层")])])},S=[],z=(s("4057"),s("8dee"),function(){return"uxxxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0,s="x"===t?e:3&e|8;return s.toString(16)}))}),Y={data:function(){return{selectIndex:""}},computed:{layerIndex:function(){return this.$state.layerIndex},layer:function(){return this.$state.layer}},mounted:function(){this.addLayer(),this.$save()},methods:{selectItem:function(t,e){e.stopPropagation(),this.$state.layerIndex=t,this.$state.selects=[]},addLayer:function(){this.$state.layer.push({name:"图层新建副本"+this.$state.layer.length,show:!0,data:[],uid:z()}),this.$state.layerIndex=this.$state.layer[this.$state.layer.length-1].uid},removeLayer:function(t,e){e.stopPropagation(),t===this.$state.layerIndex&&(this.$state.layerIndex-=1),this.$state.layer.splice(t,1),this.$state.drawIndex+=1},upLayer:function(t,e){if(e.stopPropagation(),0===t)return!1;var s=this.layer.splice(t-1,1);this.layer.splice(t,0,s[0]),this.$state.drawIndex+=1},downLayer:function(t,e){if(e.stopPropagation(),t===this.layer.length-1)return!1;var s=this.layer.splice(t+1,1);this.layer.splice(t,0,s[0]),this.$state.drawIndex+=1},showLayer:function(t,e){e.stopPropagation(),t.show=!t.show,this.$state.drawIndex+=1}}},R=Y,X=(s("b9ab"),Object(u["a"])(R,B,S,!1,null,"eb3f2e6c",null)),j=X.exports,J={components:{Palette:I,Brush:f,Draw:O,Layer:j}},N=J,P=(s("7faf"),Object(u["a"])(N,n,r,!1,null,null,null)),k=P.exports,U=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[],s=0;s<160;s++)t[s]?e.push(t[s]):e.push("4b4b4b");return e},M=[],G={width:2e3,height:2e3,gridSize:10,size:200,x:-500,y:-500,colorIndex:0,brushIndex:"brush",layerIndex:"",saveIndex:-1,drawIndex:0,showGrid:!0,showLayer:!0,paletteList:U([]),layer:[],selects:[]},L=a.a.observable(G);a.a.prototype.$state=L,a.a.prototype.$save=function(){var t=JSON.parse(JSON.stringify(L.paletteList)),e=JSON.parse(JSON.stringify(L.layer)),s=JSON.parse(JSON.stringify(L.selects));L.saveIndex+=1,L.drawIndex+=1,M[L.saveIndex]={paletteList:t,selects:s,layer:e}},a.a.prototype.$back=function(){L.saveIndex-=1,L.drawIndex+=1;var t=M[L.saveIndex];t&&(L.paletteList=t.paletteList,L.layer=t.layer,L.selects=[]),L.saveIndex<0&&(L.saveIndex=0)},a.a.prototype.$forward=function(){L.saveIndex+=1,L.drawIndex+=1;var t=M[L.saveIndex];t&&(L.paletteList=t.paletteList,L.layer=t.layer,L.selects=[])},new a.a({render:function(t){return t(k)}}).$mount("#app")},"659d":function(t,e,s){},"6b77":function(t,e,s){},"7faf":function(t,e,s){"use strict";s("6b77")},"8cc7":function(t,e,s){"use strict";s("dcf5")},b593:function(t,e,s){"use strict";s("4154")},b9ab:function(t,e,s){"use strict";s("db08")},d8be:function(t,e,s){"use strict";s("659d")},db08:function(t,e,s){},dcf5:function(t,e,s){}});
//# sourceMappingURL=app.774d1c4a.js.map